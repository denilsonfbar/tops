model = 1
if model == 1:  # Prof. Andr√© example

    # Symbols index:    0  1
    n_symbols = 2

    # States index:     A: 0   B: 1
    n_states = 2

    # Initial probabilities
    I = np.array([0.5,0.5])

    # Transition matrix
    # AA     AB
    # BA     BB
    A = np.array([[0.99,0.01], 
                  [0.3 ,0.7 ]])

    # Emission matrix
    # A0    A1
    # B0    B1
    B = np.array([[0.5,0.5],
                  [0.1,0.9]])

if model == 1:
    # sequence = np.array([0,1,1])
    sequence = np.array([0,0,0,0,1,0,1,1,1,0])
elif model == 3:
    sequence = np.array([0,1,2,3,0,1,2,3])

alpha_matrix = forward(sequence,n_states)
beta_matrix = backward(sequence,n_states)
posterior_decoding_path = posterior_decoding(alpha_matrix,beta_matrix)
viterbi_decoding_path = viterbi_decoding(sequence,n_states)

--- Results

FORWARD
Alpha matrix (log values):
[[ -1.38629436  -2.03065138  -2.72522815  -3.42660654  -4.12893635
   -4.82554686  -5.52720896  -6.22298026  -6.91140207  -7.59078927]
 [ -2.99573227  -5.58599944  -7.83979437  -9.28190351  -7.95437584
  -10.10980942  -9.23231012  -9.23643116  -9.4431875  -11.93722443]]
Alpha matrix (real values):
[[2.50000000e-01 1.31250000e-01 6.55312500e-02 3.24970313e-02
  1.60999945e-02 8.02216564e-03 3.97707378e-03 1.98332557e-03
  9.96359855e-04 5.05082249e-04]
 [5.00000000e-02 3.75000000e-03 3.93750000e-04 9.30937500e-05
  3.51122344e-04 4.06785586e-05 9.78269827e-05 9.74246631e-05
  7.92274679e-05 6.54228261e-06]]
Sequence probability:
log:  -7.57791953948236         real:  0.0005116245311825446

BACKWARD
Beta matrix (log values):
[[ -7.64642713  -6.26013277  -5.55767463  -4.85538284  -4.15427522
   -3.46164382  -2.7624889   -2.08401599  -1.3963447   -0.70117935]
 [-10.29278855  -7.29705628  -6.56244663  -5.65714561  -4.11931344
   -3.99912528  -2.06677905  -1.76425131  -1.54646311  -1.51412773]]
Beta matrix (real values):
[[4.77748016e-04 1.91099206e-03 3.85773664e-03 7.78635186e-03
  1.56971640e-02 3.13781394e-02 6.31344375e-02 1.24429500e-01
  2.47500000e-01 4.96000000e-01]
 [3.38765151e-05 6.77530302e-04 1.41242579e-03 3.49247158e-03
  1.62556710e-02 1.83316669e-02 1.26592875e-01 1.71315000e-01
  2.13000000e-01 2.20000000e-01]]
Sequence probability:
log:  -7.57791953948236         real:  0.0005116245311825446

POSTERIOR DECODING
Posterior decoding matrix (log values):
[[-6.85075880e-02 -1.04064673e-02 -2.69145050e-03 -2.96221888e-03
  -1.26606320e-02 -1.01162212e-02 -3.33054108e-02 -4.14054212e-02
  -3.46618779e-02 -1.28697340e-02]
 [-2.71486901e+00 -4.57052653e+00 -5.91902043e+00 -5.82329741e+00
  -4.37558158e+00 -4.59866893e+00 -3.41864189e+00 -3.20497474e+00
  -3.37939570e+00 -4.35930489e+00]]
Posterior decoding matrix (real values):
[[0.93378637 0.98964749 0.99731217 0.99704216 0.98741918 0.98993478
  0.96724311 0.95944007 0.96593196 0.98721273]
 [0.06621363 0.01035251 0.00268783 0.00295784 0.01258082 0.01006522
  0.03275689 0.04055993 0.03406804 0.01278727]]
Path of states:
[0 0 0 0 0 0 0 0 0 0]

VITERBI DECODING
Viterbi matrix (log values):
[[ -1.38629436  -2.08949188  -2.79268939  -3.49588691  -4.19908443
   -4.90228194  -5.60547946  -6.30867698  -7.01187449  -7.71507201]
 [ -2.99573227  -5.65499231  -8.31425235  -9.70044467  -8.20641761
  -10.86567765  -9.61281264 -10.0748481  -10.53688356 -13.1961436 ]]
Viterbi matrix (real values):
[[2.50000000e-01 1.23750000e-01 6.12562500e-02 3.03218438e-02
  1.50093127e-02 7.42960976e-03 3.67765683e-03 1.82044013e-03
  9.01117866e-04 4.46053343e-04]
 [5.00000000e-02 3.50000000e-03 2.45000000e-04 6.12562500e-05
  2.72896594e-04 1.91027616e-05 6.68664879e-05 4.21258874e-05
  2.65393090e-05 1.85775163e-06]]
Paths of states: 
[[0 0 0 0 0 0 0 0 0 0]
 [1 1 0 0 1 0 1 1 1 1]]
Best path: 
[0 0 0 0 0 0 0 0 0 0]
Best path probability:
log:  -7.7150720088409095       real:  0.00044605334349787236
